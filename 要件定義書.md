# 電子カルテシステム 要件定義書

## 1. プロジェクト概要

### 1.1 目的
自費で個人に対して顧問医師サービスを展開している企業が、患者のカルテを管理するためのWebアプリケーションを構築する。

### 1.2 背景
- 定期健康診断結果の入力・管理
- 突発的な受診結果の入力・管理
- 患者の継続的なカルテデータの蓄積
- 時系列での検査結果閲覧
- 基準値との比較表示
- カテゴリ別フィルタリング

### 1.3 対象ユーザー
- **顧問医師**：自身が担当する患者のデータを閲覧・入力
- **管理者**：全データの管理・閲覧権限を持つ

---

## 2. 機能要件

### 2.1 マスタ管理機能

#### 2.1.1 検査項目マスタ管理
- **機能概要**：検査項目のマスタデータを管理
- **必須項目**：
  - 項目名（例：白血球数）
  - 項目コード（例：WBC）
  - カテゴリ（糖尿、貧血、血液、尿、身長体重、その他）
  - 単位（例：/µl, g/dl, %）
  - 基準値下限
  - 基準値上限
  - 表示順序
- **任意項目**：
  - 備考
- **機能詳細**：
  - 検査項目の登録・編集・削除
  - カテゴリ別の一覧表示
  - 表示順序によるソート
  - 基準値表示（「下限~上限」形式）

#### 2.1.2 顧問医師マスタ管理
- **機能概要**：顧問医師の情報を管理（権限管理用）
- **必須項目**：
  - 医師ID
  - 氏名
  - メールアドレス（ログイン用）
  - 登録日時（自動）
- **任意項目**：
  - 所属
  - 専門分野（複数選択可）
  - 備考
- **機能詳細**：
  - 顧問医師の登録・編集・削除
  - ログイン認証との連携
  - 管理者権限チェック（管理者のみアクセス可能）
  - カード形式での一覧表示
  - 削除時の確認ダイアログ

#### 2.1.3 患者マスタ管理
- **機能概要**：患者の基本情報を管理
- **必須項目**：
  - 患者ID
  - 氏名
  - 性別（男、女、その他）
  - 生年月日
  - 顧問医師（関係：顧問医師マスタ）
  - 登録日時（自動）
- **任意項目**：
  - フリガナ
  - 電話番号
  - メールアドレス
  - 住所
  - 備考
- **計算項目**：
  - 年齢（生年月日から自動計算）
- **機能詳細**：
  - 患者の登録・編集・削除
  - 顧問医師別の一覧表示
  - 患者詳細画面への遷移
  - 年齢の自動計算

---

### 2.2 診療記録管理機能

#### 2.2.1 受診記録管理
- **機能概要**：患者の受診記録を管理
- **必須項目**：
  - 受診ID
  - 患者（関係：患者マスタ）
  - 受診日
  - 受診種別（定期健診、突発的受診、その他）
  - 作成者（自動）
  - 作成日時（自動）
- **任意項目**：
  - 診断名
  - 主訴
  - 所見
  - 処置内容
  - 処方内容
  - 備考
- **自動項目**：
  - 最終更新日時（自動）
- **機能詳細**：
  - 受診記録の登録・編集・削除
  - 受診日順の一覧表示（降順）
  - 患者別のフィルタリング
  - 顧問医師別のフィルタリング（自身が担当する患者のみ）

#### 2.2.2 検査結果管理
- **機能概要**：検査結果の詳細データを管理
- **必須項目**：
  - 結果ID
  - 患者（関係：患者マスタ）
  - 検査日
  - 検査項目（関係：検査項目マスタ）
  - 結果値（数値）
  - 作成者（自動）
  - 作成日時（自動）
- **任意項目**：
  - 受診記録（関係：受診記録）
  - 結果コメント
  - 補足コメント
- **自動計算項目**：
  - 単位（検査項目マスタから自動取得）
  - 基準値下限（検査項目マスタから自動取得）
  - 基準値上限（検査項目マスタから自動取得）
  - カテゴリ（検査項目マスタから自動取得）
  - 基準値判定（基準値内/基準値超/基準値未満）
- **機能詳細**：
  - 検査結果の登録・編集・削除
  - 一括入力機能（複数の検査項目を一度に入力）
  - テンプレート機能（よく使う検査項目セットを保存）
  - 基準値判定の自動計算
  - 基準値超えのハイライト表示

---

### 2.3 表示・閲覧機能

#### 2.3.1 患者一覧画面
- **機能概要**：患者の一覧を表示
- **表示項目**：
  - 患者ID、氏名、性別、生年月日、年齢、顧問医師
- **表示オプション**：
  - 顧問医師でグループ化
  - 登録日で降順ソート
  - 検索機能（氏名、患者ID）
- **操作機能**：
  - 患者詳細画面への遷移（行クリック）
  - 新規患者登録
  - 顧問医師管理画面への遷移
- **権限**：
  - 顧問医師：自身が担当する患者のみ表示
  - 管理者：全患者を表示

#### 2.3.2 患者詳細画面（患者軸カルテ）
- **機能概要**：患者ごとのカルテを時系列で表示
- **表示セクション**：
  1. **患者基本情報**
     - 氏名、性別、生年月日、年齢、顧問医師、連絡先など
     - 患者情報の編集機能
  2. **検査結果時系列**
     - 検査日でグループ化
     - 検査項目でソート
     - カテゴリ別フィルタリング（ALL/糖尿/貧血/血液/尿/身長体重）
     - 基準値判定による色分け表示
     - 表形式での時系列表示（検査項目×検査日のマトリックス表示）
     - 横スクロール機能（検査回数が多く日付が多い場合、表内を横スクロールで閲覧可能）
     - **表出力項目**：以下の全検査項目を表形式で表示（詳細は「12.3 検査項目詳細リスト」を参照）
     - **日付選択機能**：表示する検査日を選択/非選択可能（チェックボックスで複数選択）
     - **表示オプション**：
       - 単位表示のON/OFF切り替え
       - 基準値表示のON/OFF切り替え
  3. **受診記録一覧**
     - 受診日順（降順）
     - 受診種別、診断名、主訴、所見など
- **操作機能**：
  - 患者基本情報の編集
  - 検査結果の追加
  - 検査結果の編集（既存データの更新）
  - 検査日の選択/非選択（全選択/全解除機能付き）
- **機能詳細**：
  - 時系列での検査結果の推移表示
  - 基準値超えのハイライト表示
  - カテゴリ別のタブ切り替え
  - 検査結果のグラフ表示（オプション）
  - 検査結果表の横スクロール対応（検査日が多い場合でも全データを閲覧可能）
  - デフォルトで全ての検査日を表示

#### 2.3.3 基準値超え一覧
- **機能概要**：基準値を超えた検査結果を一覧表示
- **表示条件**：
  - 基準値判定 = 「基準値超」または「基準値未満」
  - 患者の顧問医師 = 現在のユーザー（顧問医師の場合）
- **表示項目**：
  - 患者名、検査日、検査項目、結果値、基準値、基準値判定
- **ソート**：
  - 検査日で降順

#### 2.3.4 受診記録一覧
- **機能概要**：受診記録の一覧を表示
- **表示条件**：
  - 患者の顧問医師 = 現在のユーザー（顧問医師の場合）
- **表示項目**：
  - 受診日、患者名、受診種別、診断名、主訴、所見
- **ソート**：
  - 受診日で降順

#### 2.3.5 ホーム画面（ダッシュボード）
- **機能概要**：システムのトップ画面。主要な操作へのアクセスを提供
- **表示項目**：
  - 患者一覧へのクイックアクセス
  - 主要な統計情報（オプション）
- **操作機能**：
  - 新規患者登録
  - 各管理画面への遷移
- **機能詳細**：
  - 患者登録ダイアログによる新規患者の登録
  - 患者一覧の表示（簡易版）

---

### 2.4 データ入力機能

#### 2.4.1 定期健康診断結果の入力
- **入力フロー**：
  1. 患者を選択
  2. 受診記録を作成（受診日、受診種別：定期健診）
  3. 検査結果を複数入力（検査項目を選択、結果値を入力）
  4. 基準値は自動取得、基準値判定は自動計算
- **入力可能な検査項目**：
  - 以下の全検査項目から選択して入力可能（詳細は「12.3 検査項目詳細リスト」を参照）
- **効率化機能**：
  - テンプレート機能（よく使う検査項目セットを保存）
  - 一括入力機能（複数の検査項目を一度に入力）
  - 前回結果の複製機能

#### 2.4.2 突発的受診結果の入力
- **入力フロー**：
  1. 患者を選択
  2. 受診記録を作成（受診日、受診種別：突発的受診、主訴、診断名、所見を入力）
  3. 必要に応じて検査結果を入力

#### 2.4.3 データ一括インポート
- **機能概要**：CSV形式での一括インポート
- **対応データ**：
  - 患者マスタ
  - 検査結果
  - 受診記録
- **機能詳細**：
  - CSVファイルのアップロード
  - データ形式の検証
  - インポート結果の確認

---

### 2.5 検索・フィルタ機能

#### 2.5.1 患者検索
- **検索条件**：
  - 氏名（部分一致）
  - 患者ID（完全一致）
  - 顧問医師
  - 性別
  - 年齢範囲

#### 2.5.2 検査結果フィルタ
- **フィルタ条件**：
  - 患者
  - 検査日範囲
  - 検査項目（以下に記載の全項目から選択可能）
  - カテゴリ
  - 基準値判定（基準値内/基準値超/基準値未満）
- **検索画面**：
  - **TOP経由検索**：トップページからの検索画面で、以下の全検査項目を検索条件として選択可能
  - **詳細経由検索**：患者詳細画面等からの検索画面で、以下の全検査項目を検索条件として選択可能
  - 両方の検索画面で同一の検査項目リストを使用
- **検索可能な検査項目一覧**：
  - 詳細は「12.3 検査項目詳細リスト」を参照

#### 2.5.3 受診記録フィルタ
- **フィルタ条件**：
  - 患者
  - 受診日範囲
  - 受診種別

---

### 2.6 AIチャット機能

#### 2.6.1 AIチャットボックス
- **機能概要**：LLM（大規模言語モデル）を活用したチャット機能
- **機能詳細**：
  - マークダウン形式でのメッセージ表示
  - ストリーミング対応によるリアルタイム応答表示
  - メッセージ履歴の管理
  - カスタマイズ可能なプロンプト提案機能
  - テーマ対応（ダークモード/ライトモード）
- **技術仕様**：
  - Streamdownによるマークダウンレンダリング
  - 自動スクロール機能
  - ローディング状態の表示
  - エラーハンドリング
- **用途**：
  - 医療データの分析支援
  - 検査結果の解釈支援
  - 一般的な質問応答

---

### 2.7 地図機能

#### 2.7.1 Google Maps統合
- **機能概要**：Google Maps APIを利用した地図表示機能
- **機能詳細**：
  - 地図の表示と操作
  - マーカーの表示
  - 位置情報の取得と表示
  - 複数のGoogle Mapsライブラリ対応：
    - marker（マーカー表示）
    - places（場所検索）
    - geocoding（住所検索）
    - geometry（距離計算など）
    - routes（ルート検索）
- **技術仕様**：
  - Forge API経由でのGoogle Maps APIアクセス
  - 動的スクリプトローディング
  - カスタマイズ可能な初期設定（中心座標、ズームレベル）

---

## 3. 非機能要件

### 3.1 セキュリティ要件

#### 3.1.1 認証・認可
- **認証方式**：
  - メールアドレスとパスワードによる認証
  - Manus認証（OAuth連携）
  - セッション管理
  - パスワードのハッシュ化保存
- **Manus認証**：
  - Manusダイアログによる認証フロー
  - OAuth連携によるシングルサインオン（SSO）
  - 認証状態の管理
- **認可**：
  - ロールベースアクセス制御（RBAC）
  - 顧問医師：自身が担当する患者データのみアクセス可能
  - 管理者：全データにアクセス可能
  - 管理者権限チェック機能（特定画面へのアクセス制御）
- **データ分離**：
  - 顧問医師間でのデータベース共有を防止
  - 各顧問医師は自身が担当する患者データのみアクセス可能

#### 3.1.2 データ保護
- **暗号化**：
  - 通信の暗号化（HTTPS）
  - 機密情報の暗号化保存
- **アクセスログ**：
  - データアクセスのログ記録
  - 定期的なアクセスログの確認

#### 3.1.3 個人情報保護
- **個人情報の取り扱い**：
  - 個人情報保護法への準拠
  - データの適切な管理
  - 不要データの削除

---

### 3.2 パフォーマンス要件

#### 3.2.1 レスポンス時間
- **画面表示**：
  - 一覧画面：2秒以内
  - 詳細画面：3秒以内
  - 検索結果：2秒以内
- **データ入力**：
  - 保存処理：1秒以内

#### 3.2.2 同時接続数
- **想定同時接続数**：50ユーザー
- **ピーク時**：100ユーザー

#### 3.2.3 データ量
- **想定データ量**：
  - 患者数：1,000件
  - 検査結果：10,000件/年
  - 受診記録：5,000件/年

---

### 3.3 可用性要件

#### 3.3.1 稼働率
- **目標稼働率**：99.5%以上
- **メンテナンス時間**：月1回、深夜帯（2時間以内）

#### 3.3.2 バックアップ
- **バックアップ頻度**：日次
- **バックアップ保持期間**：30日
- **リストア時間**：4時間以内

---

### 3.4 ユーザビリティ要件

#### 3.4.1 操作性
- **直感的なUI**：
  - わかりやすいナビゲーション
  - 適切なエラーメッセージ
  - 入力支援機能（オートコンプリートなど）
- **大量データの表示**：
  - 検査結果表の横スクロール機能（検査回数が多く日付が多い場合でも全データを閲覧可能）
  - 検査項目列の固定表示（横スクロール時も検査項目名を常に表示）
- **レスポンシブデザイン**：
  - PC、タブレット、スマートフォンに対応

#### 3.4.2 アクセシビリティ
- **対応ブラウザ**：
  - Chrome（最新版）
  - Firefox（最新版）
  - Safari（最新版）
  - Edge（最新版）

---

### 3.5 保守性要件

#### 3.5.1 ログ機能
- **アプリケーションログ**：
  - エラーログ
  - アクセスログ
  - 操作ログ
- **ログ保持期間**：90日

#### 3.5.2 監視機能
- **システム監視**：
  - サーバーリソース監視
  - データベース監視
  - アプリケーション監視

---

## 4. データモデル

### 4.1 エンティティ一覧

#### 4.1.1 顧問医師マスタ（Doctors）
| 項目名 | データ型 | 制約 | 説明 |
|--------|---------|------|------|
| doctor_id | VARCHAR | PK, NOT NULL | 医師ID |
| name | VARCHAR | NOT NULL | 氏名 |
| email | VARCHAR | UNIQUE, NOT NULL | メールアドレス |
| affiliation | VARCHAR | | 所属 |
| specialties | JSON | | 専門分野（配列） |
| notes | TEXT | | 備考 |
| created_at | TIMESTAMP | NOT NULL | 登録日時 |
| updated_at | TIMESTAMP | NOT NULL | 最終更新日時 |

#### 4.1.2 患者マスタ（Patients）
| 項目名 | データ型 | 制約 | 説明 |
|--------|---------|------|------|
| patient_id | VARCHAR | PK, NOT NULL | 患者ID |
| name | VARCHAR | NOT NULL | 氏名 |
| name_kana | VARCHAR | | フリガナ |
| gender | ENUM | NOT NULL | 性別（男、女、その他） |
| birth_date | DATE | NOT NULL | 生年月日 |
| phone | VARCHAR | | 電話番号 |
| email | VARCHAR | | メールアドレス |
| address | TEXT | | 住所 |
| doctor_id | VARCHAR | FK, NOT NULL | 顧問医師ID |
| notes | TEXT | | 備考 |
| created_at | TIMESTAMP | NOT NULL | 登録日時 |
| updated_at | TIMESTAMP | NOT NULL | 最終更新日時 |

#### 4.1.3 検査項目マスタ（Test Items）
| 項目名 | データ型 | 制約 | 説明 |
|--------|---------|------|------|
| item_id | VARCHAR | PK, NOT NULL | 項目ID |
| item_name | VARCHAR | NOT NULL | 項目名 |
| item_code | VARCHAR | UNIQUE, NOT NULL | 項目コード |
| category | ENUM | NOT NULL | カテゴリ |
| unit | VARCHAR | NOT NULL | 単位 |
| reference_min | DECIMAL | | 基準値下限 |
| reference_max | DECIMAL | | 基準値上限 |
| display_order | INTEGER | | 表示順序 |
| notes | TEXT | | 備考 |
| created_at | TIMESTAMP | NOT NULL | 登録日時 |
| updated_at | TIMESTAMP | NOT NULL | 最終更新日時 |

#### 4.1.4 受診記録（Visits）
| 項目名 | データ型 | 制約 | 説明 |
|--------|---------|------|------|
| visit_id | VARCHAR | PK, NOT NULL | 受診ID |
| patient_id | VARCHAR | FK, NOT NULL | 患者ID |
| visit_date | DATE | NOT NULL | 受診日 |
| visit_type | ENUM | NOT NULL | 受診種別 |
| diagnosis | TEXT | | 診断名 |
| chief_complaint | TEXT | | 主訴 |
| findings | TEXT | | 所見 |
| treatment | TEXT | | 処置内容 |
| prescription | TEXT | | 処方内容 |
| notes | TEXT | | 備考 |
| created_by | VARCHAR | FK, NOT NULL | 作成者（医師ID） |
| created_at | TIMESTAMP | NOT NULL | 作成日時 |
| updated_at | TIMESTAMP | NOT NULL | 最終更新日時 |

#### 4.1.5 検査結果（Test Results）
| 項目名 | データ型 | 制約 | 説明 |
|--------|---------|------|------|
| result_id | VARCHAR | PK, NOT NULL | 結果ID |
| patient_id | VARCHAR | FK, NOT NULL | 患者ID |
| visit_id | VARCHAR | FK | 受診記録ID |
| test_date | DATE | NOT NULL | 検査日 |
| item_id | VARCHAR | FK, NOT NULL | 検査項目ID |
| result_value | DECIMAL | NOT NULL | 結果値 |
| result_comment | TEXT | | 結果コメント |
| additional_comment | TEXT | | 補足コメント |
| created_by | VARCHAR | FK, NOT NULL | 作成者（医師ID） |
| created_at | TIMESTAMP | NOT NULL | 作成日時 |
| updated_at | TIMESTAMP | NOT NULL | 最終更新日時 |

### 4.2 リレーションシップ

```
Doctors (顧問医師マスタ)
  └─ 1:N ─→ Patients (患者マスタ)
            └─ 1:N ─→ Visits (受診記録)
                      └─ 1:N ─→ Test Results (検査結果)
                                  └─ N:1 ─→ Test Items (検査項目マスタ)
```

---

## 5. 画面設計

### 5.1 画面一覧

#### 5.1.1 認証関連
- **ログイン画面**
- **パスワードリセット画面**
- **Manus認証ダイアログ**

#### 5.1.2 マスタ管理
- **検査項目マスタ一覧画面**
- **検査項目マスタ登録・編集画面**
- **顧問医師マスタ一覧画面**
- **顧問医師マスタ登録・編集画面**

#### 5.1.3 患者管理
- **ホーム画面（ダッシュボード）**
- **患者一覧画面**
- **患者登録・編集画面**
- **患者詳細画面（患者軸カルテ）**

#### 5.1.4 診療記録
- **受診記録一覧画面**
- **受診記録登録・編集画面**
- **検査結果一覧画面**
- **検査結果登録・編集画面**
- **基準値超え一覧画面**

#### 5.1.5 管理機能
- **ダッシュボード画面**
- **ユーザー管理画面**
- **システム設定画面**

#### 5.1.6 AI・その他機能
- **AIチャット画面**
- **地図表示画面**

---

### 5.2 主要画面の詳細設計

#### 5.2.1 患者詳細画面（患者軸カルテ）

**レイアウト構造：**
```
┌─────────────────────────────────────┐
│ 患者基本情報                         │
│ - 氏名、性別、生年月日、年齢、顧問医師│
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│ 検査結果時系列                       │
│ [タブ: ALL | 血液 | 糖尿 | 貧血...] │
│                                     │
│ ▼ 2024年12月3日                     │
│   白血球数: 5000 /µl (基準値内)     │
│   赤血球数: 450 万/µl (基準値内)    │
│   ...                                │
│                                     │
│ ▼ 2024年10月12日                    │
│   白血球数: 10030 /µl (基準値超) 🔴 │
│   ...                                │
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│ 受診記録一覧                         │
│ 2024年12月3日 - 定期健診            │
│ 2024年10月12日 - 突発的受診         │
│ ...                                  │
└─────────────────────────────────────┘
```

**機能詳細：**
- 検査結果の時系列表示（検査日でグループ化）
- 表形式でのマトリックス表示（検査項目×検査日）
- カテゴリ別タブ切り替え
- 基準値判定による色分け表示
- 横スクロール機能（検査回数が多く日付が多い場合、表内を横スクロールで閲覧可能）
- グラフ表示（オプション）

---

## 6. API設計

### 6.1 認証API
- `POST /api/auth/login` - ログイン
- `POST /api/auth/logout` - ログアウト
- `POST /api/auth/refresh` - トークンリフレッシュ

### 6.2 マスタAPI
- `GET /api/masters/test-items` - 検査項目一覧取得
- `POST /api/masters/test-items` - 検査項目登録
- `PUT /api/masters/test-items/:id` - 検査項目更新
- `DELETE /api/masters/test-items/:id` - 検査項目削除
- `GET /api/masters/doctors` - 顧問医師一覧取得
- `POST /api/masters/doctors` - 顧問医師登録
- `PUT /api/masters/doctors/:id` - 顧問医師更新
- `DELETE /api/masters/doctors/:id` - 顧問医師削除

### 6.3 患者API
- `GET /api/patients` - 患者一覧取得
- `GET /api/patients/:id` - 患者詳細取得
- `POST /api/patients` - 患者登録
- `PUT /api/patients/:id` - 患者更新
- `DELETE /api/patients/:id` - 患者削除

### 6.4 診療記録API
- `GET /api/visits` - 受診記録一覧取得
- `GET /api/visits/:id` - 受診記録詳細取得
- `POST /api/visits` - 受診記録登録
- `PUT /api/visits/:id` - 受診記録更新
- `DELETE /api/visits/:id` - 受診記録削除
- `GET /api/test-results` - 検査結果一覧取得
- `GET /api/test-results/:id` - 検査結果詳細取得
- `POST /api/test-results` - 検査結果登録
- `POST /api/test-results/bulk` - 検査結果一括登録
- `PUT /api/test-results/:id` - 検査結果更新
- `DELETE /api/test-results/:id` - 検査結果削除
- `GET /api/test-results/abnormal` - 基準値超え一覧取得

---

## 7. 技術要件

### 7.1 フロントエンド
- **フレームワーク**：React / Vue.js / Next.js（要検討）
- **UIライブラリ**：Material-UI / Ant Design / Tailwind CSS（要検討）
- **状態管理**：Redux / Zustand / Context API（要検討）
- **グラフライブラリ**：Chart.js / Recharts（オプション）

### 7.2 バックエンド
- **フレームワーク**：Node.js (Express) / Python (Django/FastAPI) / Ruby on Rails（要検討）
- **認証**：JWT / Session（要検討）
- **ORM**：Prisma / Sequelize / TypeORM（要検討）

### 7.3 データベース
- **DBMS**：PostgreSQL / MySQL（要検討）
- **要件**：
  - トランザクション対応
  - 外部キー制約
  - インデックス最適化

### 7.4 インフラ
- **ホスティング**：AWS / GCP / Azure（要検討）
- **コンテナ**：Docker
- **CI/CD**：GitHub Actions / GitLab CI（要検討）

---

## 8. 開発計画

### 8.1 開発フェーズ

#### フェーズ1：基本機能の実装（4週間）
- 認証機能
- マスタ管理機能
- 患者管理機能（基本）

#### フェーズ2：診療記録機能の実装（4週間）
- 受診記録管理
- 検査結果管理
- 基準値判定

#### フェーズ3：表示・閲覧機能の実装（4週間）
- 患者詳細画面（患者軸カルテ）
- 時系列表示
- カテゴリ別フィルタリング
- 基準値超え一覧

#### フェーズ4：最適化・テスト（2週間）
- パフォーマンス最適化
- セキュリティ強化
- テスト実施
- バグ修正

### 8.2 マイルストーン
- **M1**：基本機能完成（8週間後）
- **M2**：全機能完成（12週間後）
- **M3**：リリース準備完了（14週間後）

---

## 9. テスト計画

### 9.1 テスト種別
- **単体テスト**：各機能の動作確認
- **結合テスト**：API連携の確認
- **システムテスト**：全体の動作確認
- **セキュリティテスト**：認証・認可の確認
- **パフォーマンステスト**：レスポンス時間の確認

### 9.2 テスト項目
- 認証・認可の動作確認
- データのCRUD操作
- 権限によるデータ分離の確認
- 基準値判定の計算精度
- 時系列表示の正確性

---

## 10. 運用・保守計画

### 10.1 運用体制
- **監視**：24時間監視（自動アラート）
- **サポート**：平日9:00-18:00
- **メンテナンス**：月1回、深夜帯

### 10.2 バックアップ・復旧
- **バックアップ**：日次自動バックアップ
- **復旧時間目標（RTO）**：4時間
- **復旧ポイント目標（RPO）**：24時間

### 10.3 バージョン管理
- **リリースサイクル**：月1回
- **緊急修正**：随時対応

---

## 11. リスク管理

### 11.1 技術的リスク
- **データベースパフォーマンス**：インデックス最適化、クエリ最適化
- **セキュリティ脆弱性**：定期的なセキュリティ監査
- **スケーラビリティ**：将来の拡張性を考慮した設計

### 11.2 プロジェクトリスク
- **スケジュール遅延**：バッファ期間の確保
- **要件変更**：変更管理プロセスの確立
- **リソース不足**：適切なリソース配分

---

## 12. 付録

### 12.1 用語集
- **カルテ**：患者の診療記録
- **基準値**：検査結果の正常範囲
- **顧問医師**：患者を担当する医師
- **受診種別**：定期健診、突発的受診など

### 12.2 参考資料
- 個人情報保護法
- 医療情報システムの安全管理に関するガイドライン
- 電子カルテシステムの機能要件（厚生労働省）

### 12.3 検査項目詳細リスト

検索結果の入力項目（TOP経由、詳細経由両方）および検査結果の表出力項目として使用する検査項目の詳細リスト。

#### ①身体
- 身長 (cm)
- 体重 (kg)
- BMI
- 腹囲 (cm)
- 体脂肪率 (%)
- 除脂肪率 (kg)
- 基礎代謝量 (kcal/day)
- 視力裸眼 (右/左)
- 視力矯正 (右/左)
- 聴力 (4000Hz,右)
- 聴力 (4000Hz,左)
- 聴力 (1000Hz,右)
- 聴力 (1000Hz,左)
- 眼圧 (右/左)
- 修正眼圧 (右/左)
- 同年齢比較(Z値) (%)
- 若年比較(YAM,t値) (%)

#### ②脳・血管
- 頸動脈エコー
- 頭部MRI/MRA
- 血中酸素ウェルネス低下指数(ODI) (回)
- 睡眠の安定度 (%)

#### ③肺機能
- 肺活量 (L)
- %肺活量(%VC) (%)
- 1秒量(FEV1) (L)
- %1秒量(%FEV1) (%)
- 1秒率(FEV1%) (%)
- 努力性肺活量(FVC) (L)
- ピークフロー (L/sec)
- 予測肺活量 (L)
- KL-6

#### ④血圧
- 収縮期血圧 (mmHg)
- 拡張期血圧 (mmHg)

#### ⑤血液
- 赤血球数 (x10^6/µL) - 基準値: 男性 435～555 (x10^4/µL)、女性 386～492 (x10^4/µL) ※単位注意
- Hb (g/dL) - 基準値: 男性 13.7～16.8、女性 11.6～14.8
- Ht (%) - 基準値: 男性 40.7～50.1、女性 35.1～44.4
- 鉄 (µg/dL)
- フェリチン (ng/mL) - 基準値: 男性 25～280、女性 10～120
- 網状赤血球 (‰) - 基準値: 男性 3.6～20.6、女性 3.6～22.0
- LDH (U/L) - 基準値: 120～240
- 白血球数 (x10^3/µL) - 基準値: 3.3～8.6 (男性)
- 好中球(%) - 基準値: 男性 45.2～68.8、女性 49.7～72.7
- リンパ球 (%) - 基準値: 男性 26.8～43.8、女性 24.5～38.9
- 単球 (%) - 基準値: 男性 2.7～7.9、女性 1.7～8.7
- 好酸球 (%) - 基準値: 男性 0.0～10.0、女性 0.0～5.0
- 好塩基球 (%) - 基準値: 男性 0.0～5.0、女性 0.0～3.0
- 血小板数 (x10^4/µL) - 基準値: 15.8～34.8
- MCV (fL) - 基準値: 83.6～98.2
- MCH (pg) - 基準値: 27.5～33.2
- MCHC (%) - 基準値: 31.7～35.3 (g/dL) ※単位注意
- 総鉄結合能(TIBC) (μg/dL)
- 不飽和鉄結合能(UIBC) (μg/dL)
- ABO
- RH

#### ⑥脂質代謝
- 総コレステロール (mg/dL)
- HDLコレステロール (mg/dL)
- LDLコレステロール (mg/dL)
- L/H比
- non-HDLコレステロール (mg/dL)
- sd-LDL (mg/dL)
- 空腹時中性脂肪 (mg/dL)
- NT-proBNP

#### ⑦糖代謝
- 空腹時血糖 (mg/dL)
- HbA1c (%)
- 1,5-AG (µg/mL)
- グリコアルブミン (%)
- 食後2時間血糖 (mg/dL)

#### ⑧腎・尿路系
- 尿蛋白 - 基準値: (－)
- 尿潜血 - 基準値: (－)
- 尿糖 - 基準値: (－)
- 尿中ウロビリノーゲン - 基準値: n
- 尿pH - 基準値: 4.6～7.5
- 尿比重 - 基準値: 1.006～1.022
- 尿酸 (mg/dL) - 基準値: 男性 3.0～7.0、女性 2.5～7.0
- 尿素窒素 (mg/dL) - 基準値: 8～20
- クレアチニン (mg/dL) - 基準値: 男性 0.6～1.2、女性 0.4～1.0
- eGFR (mL/min/1.73m2) - 基準値: 60以上
- Na (mEq/L) - 基準値: 138～146
- K (mEq/L) - 基準値: 3.6～5.0
- Cl (mEq/L) - 基準値: 98～110
- 尿中アルブミン (mg/gCre) - 基準値: 30未満
- 白血球（尿沈渣） - 基準値: (－)
- 赤血球（尿沈渣）
- 扁平上皮（尿沈渣）
- 尿路上皮（尿沈渣）
- 円柱（尿沈渣）
- 細菌（尿沈渣）
- L-FABP (μg/gCre)

#### ⑨肝胆膵
- AST (U/L) - 基準値: 10～40
- ALT (U/L) - 基準値: 5～45
- γ-GTP (U/L) - 基準値: 男性 0～79、女性 0～48
- 総ビリルビン (mg/dL) - 基準値: 0.2～1.2
- 直接ビリルビン (mg/dL) - 基準値: 0.0～0.4
- 間接ビリルビン (mg/dL)
- CPK (U/L) - 基準値: 男性 40～200、女性 30～120
- Ch-E (U/L) - 基準値: 男性 234～494、女性 196～452
- 総蛋白 (g/dL) - 基準値: 6.6～8.1
- A/G比 - 基準値: 1.1～2.0
- アルブミン量 (g/dL) - 基準値: 3.8～5.3
- アミラーゼ (U/L) - 基準値: 37～125
- HBs抗原 (定性) - 基準値: (－)
- HCV抗体 - 基準値: (－)
- LDH (U/L) - 基準値: 120～240
- ALP (U/L) - 基準値: 100～340
- セルロプラスミン (mg/dL) - 基準値: 20～35
- 蛋白分画(アルブミン) (%)
- 蛋白分画(α1) (%)
- 蛋白分画(α2) (%)
- 蛋白分画(β1) (%)
- 蛋白分画(β2) (%)
- 蛋白分画(γ) (%)
- FIB-4 index
- 亜鉛 (μg/dL) - 基準値: 65～110
- マグネシウム (mg/dL) - 基準値: 1.8～2.4
- 血清銅 (μg/dL) - 基準値: 男性 70～130、女性 80～130
- 無機リン (mg/dL) - 基準値: 2.5～4.5
- 25OHVD (μg/mL) - 基準値: 30以上
- 1,25(OH)2VD (PG/mL) - 基準値: 20～60

#### ⑩内分泌
- リン脂質 (mg/dL) - 基準値: 150～300
- 総ホモシステイン (nmol/mL) - 基準値: 5.0～15.0
- 遊離脂肪酸 (μEq/L) - 基準値: 150～650
- カルシウム (mg/dL) - 基準値: 8.5～10.5
- TSH (μIU/mL) - 基準値: 0.35～4.94
- 遊離T3 (pg/mL) - 基準値: 1.71～3.71
- 遊離T4 (ng/dL) - 基準値: 0.70～1.48
- 甲状腺エコー

#### ⑪口腔
- 齲歯本数
- C0
- C1
- C2
- C3
- C4
- 動揺歯数
- 歯石歯数
- 健全歯数
- 歯周ポケットの深さが3以上の歯数

#### ⑫診察
- 診察所見

#### ⑬循環器
- 眼底（所見）
- 眼底（K-W）右
- 眼底（K-W）左
- 眼底（Scheie S）右
- 眼底（Scheie S）左
- 眼底（Scheie H）右
- 眼底（Scheie H）左
- 安静時心電図
- 心拍数 (/min)

#### ⑭呼吸器
- 胸部X線
- CTR(心胸郭比)
- 胸部CT

#### ⑮消化器
- 腹部エコー（肝臓所見）
- 腹部エコー（胆嚢所見）
- 腹部エコー（すい臓所見）
- 腹部エコー（腎臓所見）
- 腹部エコー（脾臓所見）
- 腹部エコー（腹部大動脈）
- 上部内視鏡所見
- 下部内視鏡所見
- 胃バリウム
- 便潜血(1回目)
- 便潜血(2回目)
- ペプシノーゲンⅠ
- ペプシノーゲンⅡ
- ペプシノーゲン比
- 血清ピロリ抗体

#### ⑯生殖器
- 子宮頸部細胞診
- HPV16
- HPV18
- HPVその他ハイリスクグループ
- 経腟エコー（子宮）
- 経腟エコー（卵巣）
- 骨盤MRI

#### ⑰乳がん
- マンモグラフィー右
- マンモグラフィー左
- 乳腺エコー右
- 乳腺エコー左

#### ⑱腫瘍マーカー
- CEA - 基準値: 5.0以下 (ng/mL)
- CA19-9 - 基準値: 37.0以下 (U/mL)
- PSA (男性) - 基準値: 2.700以下 (ng/mL)
- CA125 (女性) - 基準値: 35.0以下 (U/mL)
- AFP - 基準値: 10.0以下 (ng/mL)
- SCC抗原 - 基準値: 1.5以下 (ng/mL)
- CYFRA - 基準値: 2.2以下 (ng/mL)

#### ⑲感染症・免疫
- CRP (mg/dL) - 基準値: 0.3以下
- 赤沈 (mm/1h) - 基準値: 男性 2～10、女性 3～15
- RF (IU/mL) - 基準値: 15以下
- 抗核抗体 (倍) - 基準値: 40未満
- MPO-ANCA (U/mL) - 基準値: 3.5以下
- PR3-ANCA (U/mL) - 基準値: 3.5以下
- 抗CCP抗体 (U/mL) - 基準値: 4.5以下
- HIV抗体
- TP抗体 (定性)
- RPR (定性)
- 梅毒抗体
- HBc抗体
- HCV抗体
- サイトメガロウイルス抗体
- EBウイルス抗体
- マイコプラズマ抗体
- クラミジア抗体
- インフルエンザ抗体
- 麻疹抗体(EIA法-IgG)
- 麻疹抗体(EIA-IgG)判定
- 風疹抗体 (EIA法-IgG)
- 風疹抗体 (EIA法-IgG)判定
- 水痘抗体(EIA法-IgG)
- 水痘抗体(EIA法-IgG)判定
- ムンプス抗体(EIA法-IgG)
- ムンプス抗体(EIA法-IgG)
- ASO (IU/mL)
- ASK (IU/mL)
- C3 (mg/dL)
- C4 (mg/dL)
- CH50 (U/mL)
- IgA (mg/dL)
- IgG (mg/dL)
- IgM (mg/dL)
- IgE (IU/mL)
- T-cell (%)
- B-cell (%)
- NK細胞 (%)
- **MAST48アレルゲン**
  - ヤケヒョウヒダニ
  - コナヒョウヒダニ
  - ハウスダスト
  - スギ
  - ヒノキ
  - ハンノキ
  - シラカンバ
  - オオアワガエリ
  - カモガヤ
  - ナガハグサ
  - ハルガヤ
  - ギョウギシバ
  - ヨモギ
  - ブタクサ
  - オオブタクサ
  - ブタクサモドキ
  - イヌ皮屑
  - ネコ皮屑
  - ラテックス
  - アスペルギルス
  - カンジダ
  - アルテルナリア
  - ペニシリウム
  - クラドスポリウム
  - 卵白
  - オポムコイド
  - 牛乳
  - 小麦
  - 大豆
  - 米
  - ソバ
  - エビ
  - カニ
  - サバ
  - マグロ
  - サケ
  - ピーナッツ
  - ゴマ
  - ヘーゼルナッツ
  - クルミ
  - アーモンド
  - トマト
  - モモ
  - キウイフルーツ
  - バナナ
  - リンゴ
  - 牛肉
  - 豚肉
  - 鶏肉

---

## 13. 承認

| 役割 | 氏名 | 承認日 | 署名 |
|------|------|--------|------|
| プロジェクトマネージャー | | | |
| システム責任者 | | | |
| 顧問医師代表 | | | |

---

**文書バージョン**：1.0  
**作成日**：2024年12月  
**最終更新日**：2024年12月

